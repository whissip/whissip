/*
* bubbletip
*
* Copyright (c) 2009-2010, UhLeeKa.
* Version: 
*      1.0.6
* Licensed under the GNU Lesser General Public License:
*     http://www.gnu.org/licenses/lgpl-3.0.html
* Author Website: 
*     http://www.uhleeka.com
* Project Hosting on Google Code: 
*     http://code.google.com/p/bubbletip/
*/
(function(t){var n=0;var r=1e3;t.fn.extend({bubbletip:function(i,s){function y(){var n;if(h){return}h=true;if(p){d.stop(true,false)}if(a.calculateOnShow){w()}if(a.positionAt.match(/^element|body$/i)){if(a.deltaDirection.match(/^up|down$/i)){if(!p){d.css("top",parseInt(f.top+f.delta)+"px")}n={top:f.top+"px"}}else{if(!p){d.css("left",parseInt(f.left+f.delta)+"px")}n={left:f.left+"px"}}}else{if(a.deltaDirection.match(/^up|down$/i)){if(!p){f.mouseTop=e.pageY+f.top;d.css({top:parseInt(f.mouseTop+f.delta)+"px",left:parseInt(e.pageX-d.width()/2)+"px"})}n={top:f.mouseTop+"px"}}else{if(!p){f.mouseLeft=e.pageX+f.left;d.css({left:parseInt(f.mouseLeft+f.delta)+"px",top:parseInt(e.pageY-d.height()/2)+"px"})}n={left:f.left+"px"}}}p=false;o.css("z-index",r+1);o.css("position","relative");d.css("z-index",r);r++;d.show();n=t.extend(n,{opacity:1});d.animate(n,a.animationDuration,a.animationEasing,function(){d.css("opacity","");h=true})}function b(){var e;h=false;p=true;if(a.positionAt.match(/^element|body$/i)){if(a.deltaDirection.match(/^up|down$/i)){e={top:parseInt(f.top-f.delta)+"px"}}else{e={left:parseInt(f.left-f.delta)+"px"}}}else{if(a.deltaDirection.match(/^up|down$/i)){e={top:parseInt(f.mouseTop-f.delta)+"px"}}else{e={left:parseInt(f.mouseLeft-f.delta)+"px"}}}e=t.extend(e,{opacity:0});d.animate(e,a.animationDuration,a.animationEasing,function(){d.hide();p=false})}function w(){if(a.positionAt.match(/^element$/i)){var e=a.positionAtElement.offset();if(a.deltaDirection.match(/^up$/i)){f.top=e.top+a.offsetTop-d.outerHeight()+a.deltaShift;f.left=e.left+a.offsetLeft+(a.positionAtElement.outerWidth()-d.outerWidth())/2;f.delta=a.deltaPosition}else if(a.deltaDirection.match(/^down$/i)){f.top=e.top+a.positionAtElement.outerHeight()+a.offsetTop-a.deltaShift;f.left=e.left+a.offsetLeft+(a.positionAtElement.outerWidth()-d.outerWidth())/2;f.delta=-a.deltaPosition}else if(a.deltaDirection.match(/^left$/i)){f.top=e.top+a.offsetTop+(a.positionAtElement.outerHeight()-d.outerHeight())/2;f.left=e.left+a.offsetLeft-d.outerWidth()+a.deltaShift;f.delta=a.deltaPosition}else if(a.deltaDirection.match(/^right$/i)){f.top=e.top+a.offsetTop+(a.positionAtElement.outerHeight()-d.outerHeight())/2;f.left=e.left+a.positionAtElement.outerWidth()+a.offsetLeft-a.deltaShift;f.delta=-a.deltaPosition}}else if(a.positionAt.match(/^body$/i)){if(a.deltaDirection.match(/^up|left$/i)){f.top=a.offsetTop;f.left=a.offsetLeft;f.delta=a.deltaPosition}else{if(a.deltaDirection.match(/^down$/i)){f.top=parseInt(a.offsetTop+d.outerHeight());f.left=a.offsetLeft}else{f.top=a.offsetTop;f.left=parseInt(a.offsetLeft+d.outerWidth())}f.delta=-a.deltaPosition}}else if(a.positionAt.match(/^mouse$/i)){if(a.deltaDirection.match(/^up|left$/i)){if(a.deltaDirection.match(/^up$/i)){f.top=-(a.offsetTop+d.outerHeight());f.left=a.offsetLeft}else if(a.deltaDirection.match(/^left$/i)){f.top=a.offsetTop;f.left=-(a.offsetLeft+d.outerWidth())}f.delta=a.deltaPosition}else{f.top=a.offsetTop;f.left=a.offsetLeft;f.delta=-a.deltaPosition}}if(a.positionAt.match(/^element|body$/i)){d.css({position:"absolute",top:f.top+"px",left:f.left+"px"})}}if(t("div.bubbletip #"+t(i).get(0).id).length>0){return this}var o,u,a,f,l,c,h,p,d,v;var m,g;o=t(this);u=t(i);v=n++;a={wrapperContainer:"body",positionAt:"element",positionAtElement:o,offsetTop:0,offsetLeft:0,deltaPosition:30,deltaShift:10,deltaDirection:"up",animationDuration:250,animationEasing:"swing",bindShow:"mouseover",bindHide:"mouseout",bindClose:"click",delayShow:0,delayHide:500,calculateOnShow:false,showOnInit:false};if(s){a=t.extend(a,s)}f={top:0,left:0,delta:0,mouseTop:0,mouseLeft:0,bindShow:(a.bindShow+" ").replace(/ +/g,".bubbletip"+v),bindHide:(a.bindHide+" ").replace(/ +/g,".bubbletip"+v),bindClose:(a.bindClose+" ").replace(/ +/g,".bubbletip"+v)};l=null;c=null;h=false;p=false;if(!o.data("bubbletip_tips")){o.data("bubbletip_tips",[[u.get(0).id,v]])}else{o.data("bubbletip_tips",t.merge(o.data("bubbletip_tips"),[[u.get(0).id,v]]))}if(!a.positionAt.match(/^element|body|mouse$/i)){a.positionAt="element"}if(!a.deltaDirection.match(/^up|down|left|right$/i)){a.deltaDirection="up"}if(a.deltaDirection.match(/^up$/i)){d=t('<div class="bubbletip bt-up"><div class="bt-content"></div></div>')}else if(a.deltaDirection.match(/^down$/i)){d=t('<div class="bubbletip bt-down"><div class="bt-content"></div></div>')}else if(a.deltaDirection.match(/^left$/i)){d=t('<div class="bubbletip bt-left"><div class="bt-content"></div></div>')}else if(a.deltaDirection.match(/^right$/i)){d=t('<div class="bubbletip bt-right"><div class="bt-content"></div></div>')}d.appendTo(a.wrapperContainer);if(/msie/.test(navigator.userAgent.toLowerCase())&&!/opera/.test(navigator.userAgent.toLowerCase())){t("*",d).each(function(){var e=t(this).css("background-image");if(e.match(/^url\(["']?(.*\.png)["']?\)$/i)){e=RegExp.$1;t(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod="+(t(this).css("backgroundRepeat")=="no-repeat"?"crop":"scale")+", src='"+e+"')"}).each(function(){var e=t(this).css("position");if(e!="absolute"&&e!="relative")t(this).css("position","relative")})}})}t(".bt-content",d).append(u);u.show();d.css("opacity",0);d.css({width:d.width()+2,height:d.height()});w();d.hide();t(window).bind("resize.bubbletip"+v,function(){var e=t(window).width();var n=t(window).height();if(e===m&&n===g){return}m=e;g=n;if(c){clearTimeout(c)}c=setTimeout(function(){w()},250)});t([d.get(0),this.get(0)]).bind(f.bindShow,function(){if(l){clearTimeout(l)}if(a.delayShow===0){y()}else{l=setTimeout(function(){y()},a.delayShow)}return false}).bind(f.bindHide,function(){if(l){clearTimeout(l)}if(a.delayHide===0){b()}else{l=setTimeout(function(){b()},a.delayHide)}return false});t(d.get(0)).bind(f.bindClose,function(){p=true;d.animate({opacity:0},a.animationDuration,a.animationEasing,function(){d.hide();p=false;h=false})});if(a.showOnInit){y()}return this},removeBubbletip:function(e){var n;var r=new Array;var i=new Array;var s,o,u;var a;n=t.makeArray(t(this).data("bubbletip_tips"));s=t.makeArray(e);for(o=0;o<s.length;o++){r.push(t(s[o]).get(0).id)}for(o=0;o<n.length;o++){u=null;if(r.length==0||(u=t.inArray(n[o][0],r))>=0){a=t("#"+n[o][0]).get(0).parentNode;while(a.tagName.toLowerCase()!="table"){a=a.parentNode}t("#"+n[o][0]).appendTo(_options.wrapperContainer).hide();t(a).remove();t(this).unbind(".bubbletip"+n[o][1]);t(window).unbind(".bubbletip"+n[o][1])}else{i.push(n[o])}}t(this).data("bubbletip_tips",i);return this}})})(jQuery)